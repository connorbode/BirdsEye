/*! BirdsEye 30-01-2014 */
!function(a,b){"use strict";var c=function(a){if(this.markers=[],this.events=[],this.addMarker=function(a,b,d){var e=this.markers.push(new c.Marker(a,b,d));return this.markers[e-1]},this.setPin=function(a,b,c){var d=new a.maps.Marker({position:new a.maps.LatLng(c.lat,c.lng)});return d.setMap(b),d},this.attackMap=function(a,b){for(var d=b.getZoom(),e=0;e<=c.prototype.MAX_ZOOM;e++)this.events[e]=[];for(e=0;e<this.markers.length;e++){var f=this.markers[e],g=this.setPin(a,b,f);this.hidePin(g);for(var h=[],i=0;i<c.prototype.MAX_ZOOM;i++)h[i]=!1;for(i=0;i<f.variations.length;i++){var j=f.variations[i];this.addEvent(j.startZoom,g,j.img),this.addEvent(j.endZoom,g,j.img),d>=j.startZoom&&d<=j.endZoom&&this.setPinIcon(g,j.img);for(var k=j.startZoom;k<=j.endZoom;k++)h[k]=!0}for(i=0;i<h.length;i++)h[i]===!1&&this.addEvent(i,g,null)}a.maps.event.addListener(b,"zoom_changed",function(){this.processEvents(b)})},this.addEvent=function(a,b,d){a>=0&&a<c.prototype.MAX_ZOOM&&this.events[a].push({pin:b,val:d})},this.processEvents=function(a){for(var b=a.getZoom(),c=0;c<this.events[b].length;c++){var d=this.events[b][c],e=d.pin,f=d.val;null===f?this.hidePin(e):this.setPinIcon(e,f)}},this.hidePin=function(a){a.setVisible(!1)},this.setPinIcon=function(a,b){a.setIcon(b),a.setVisible(!0)},a!==b)for(var d=0;d<a.length;d++){var e=a[d];this.addMarker(e.lat,e.lng,e.variations)}};c.prototype.MAX_ZOOM=21,c.prototype.ERROR_MESSAGES={INVALID_LATITUDE:"latitude must be integer or double",INVALID_LONGITUDE:"longitude must be integer or double",INVALID_STARTZOOM:"startZoom must be integer",INVALID_ENDZOOM:"endZoom must be integer",STARTZOOM_EXCEEDS_MAXZOOM:"startZoom cannot exceed "+c.prototype.MAX_ZOOM,ENDZOOM_EXCEEDS_MAXZOOM:"endZoom cannot exceed "+c.prototype.MAX_ZOOM,STARTZOOM_EXCEEDS_ENDZOOM:"startZoom cannot exceed endZoom",INVALID_VARIATION_IMAGE:"variation 'img' must be a string",VARIATION_OVERLAP:"the variation you are trying to add overlaps an existing variation"},c.prototype.LAT_LNG_REGEX=/^-?\d+(.\d+)?$/,c.Marker=function(a,d,e){if(this.lat=a,this.lng=d,this.variations=[],this.variationRange=[],this.addVariation=function(a,b,d){for(var e=0;e<this.variationRange.length;e++)if(this.variationRange[e]>=b&&this.variationRange[e]<=d)throw c.prototype.ERROR_MESSAGES.VARIATION_OVERLAP;for(e=b;d>=e;e++)this.variationRange.push(e);try{var f=this.variations.push(new c.Variation(a,b,d));return this.variations[f-1]}catch(g){throw this.variations=[],this.variationRange=[],g}},!c.prototype.LAT_LNG_REGEX.test(a))throw c.prototype.ERROR_MESSAGES.INVALID_LATITUDE;if(!c.prototype.LAT_LNG_REGEX.test(d))throw c.prototype.ERROR_MESSAGES.INVALID_LONGITUDE;if(e!==b)for(var f=0;f<e.length;f++){var g=e[f];this.addVariation(g.img,g.startZoom,g.endZoom)}},c.Variation=function(a,b,d){var e=/^\d+$/;if(!e.test(b))throw c.prototype.ERROR_MESSAGES.INVALID_STARTZOOM;if(!e.test(d))throw c.prototype.ERROR_MESSAGES.INVALID_ENDZOOM;if(b>c.prototype.MAX_ZOOM)throw c.prototype.ERROR_MESSAGES.STARTZOOM_EXCEEDS_MAXZOOM;if(d>c.prototype.MAX_ZOOM)throw c.prototype.ERROR_MESSAGES.ENDZOOM_EXCEEDS_MAXZOOM;if(b>d)throw c.prototype.ERROR_MESSAGES.STARTZOOM_EXCEEDS_ENDZOOM;if("string"!=typeof a)throw c.prototype.ERROR_MESSAGES.INVALID_VARIATION_IMAGE;this.startZoom=b,this.endZoom=d,this.img=a},c.VERSION="0.0.0",a.BirdsEye=c}(this);